server:
  port: 8083
spring:
  application:
    name: "ms-persona"
  profiles:
    active: ${MS_PERSONA_PROFILE_ACTIVE}
  flyway:
    url: 'jdbc:postgresql://${MS_PERSONA_R2DBC_HOST}:${MS_PERSONA_R2DBC_PORT}/${MS_PERSONA_R2DBC_DATABASE}'
    user: '${MS_PERSONA_R2DBC_USERNAME}'
    password: '${MS_PERSONA_R2DBC_PASSWORD}'
    enabled: true
    locations: 'classpath:db/migration'
    baseline-on-migrate: true
    validate-on-migrate: true

management:
  endpoints:
    web:
      exposure:
        include: "health,prometheus"
  endpoint:
    health:
      probes:
        enabled: true
  metrics:
    tags:
      application: '${spring.application.name}'

cors:
  allowed-origins: '${CORS_ALLOWED_ORIGINS}'

adapters:
  r2dbc:
    host: '${MS_PERSONA_R2DBC_HOST}'
    port: '${MS_PERSONA_R2DBC_PORT}'
    database: '${MS_PERSONA_R2DBC_DATABASE}'
    schema: '${MS_PERSONA_R2DBC_SCHEMA}'
    username: '${MS_PERSONA_R2DBC_USERNAME}'
    password: '${MS_PERSONA_R2DBC_PASSWORD}'

---
spring:
  config:
    activate:
      on-profile: test
  flyway:
    enabled: false
  r2dbc:
    url: r2dbc:h2:mem:///testdb;DB_CLOSE_DELAY=-1
    username: sa
    password:
  h2:
    console:
      enabled: true
      path: /h2-console

---
spring:
  config:
    activate:
      on-profile: dev
logging:
  level:
    co.com.persona: DEBUG
    org.springframework.r2dbc: DEBUG

---
spring:
  config:
    activate:
      on-profile: prod
logging:
  level:
    com.persona: INFO
